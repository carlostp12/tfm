%document identification for conditional
\providecommand\jobname{tsa}

\newcommand{\tsaadministracion}[0]{
	\section{Administración}
	Antes de poner en marcha el sistema es necesario inicializar el servicio, para ello habría que crear los certificados internos, también hay que editar las políticas ya que vienen configuradas unas políticas por defecto.
	Finalizada la instalación, el sistema está preparado para dar el servicio de generación de sellos de tiempo conforme al estándar [RFC3161] mediante el servicio TSP (Ver sección \ref{servicio_tsp}), administrando los servicios de TSA a través de la interfaz de administración Web entre otras funcionalidades que se detallarán más adelante.

	\subsection{Asistente de instalación}

	\input{asistente_instalacion.tex}

	\subsection{Administración web}

	\input{administracion_web_01.tex}

	Así podremos acceder con diferentes permisos según los certificados que tengamos instalados. Los roles disponibles que encapsulan las operaciones habilitadas son:
	\begin{itemize}
		\item Auditor: Autorizado para ver los datos generados por la TSA (certificados emitidos, sellos de tiempo, operadores) y las trazas de las operaciones realizadas (logs).
		\item Administrador de Sistema (SystemAdmin): Están autorizados para instalar, mantener y configurar el Software de los equipos de la TSA siempre y cuando no afecte a la seguridad del mismo.
		\item Administrador de Seguridad (SecurityAdmin): Tiene la responsabilidad general para la administración del Software de los equipos de la TSA siempre que afecten a la seguridad.
		\item Operador de sistema (SystemOperator): Tiene la responsabilidad de monitorizar los equipos de la TSA y realizar operaciones de mantenimientos.
	\end{itemize}

	Entre las operaciones principales que podemos encontrar en la interfaz de administración se enumeran las siguientes, que se detallarán más adelante en el punto que corresponda:

	\begin{enumerate}
		\item Consulta de sellos de tiempo emitidos.
		\item Provisión de hora a los equipos de los otros componentes de Realsec.
	\end{enumerate}

	\subsubsection{Administración web para el rol Administrador de Seguridad}

	Mediante el rol administrador de seguridad, se pueden configurar los parámetros que condicionan el funcionamiento de los elementos software específicos de la TSA que afectan a la seguridad del sistema. Entre estas funcionalidades se encuentran la gestión de políticas de certificación, configuración de certificado de TSA, de restauración de claves, configuración de acceso al sistema operativo, copia de seguridad de datos, restauración de datos, consulta de certificados internos, la gestión de acceso de los roles, la gestión de certificados de MiniCA, operadores o servidor.

	\paragraph{Administración}

	Este menú proporciona distintas opciones relacionadas con la configuración de seguridad del componente TSA.  Las operaciones permitidas en el menú administración son:
	\begin{itemize}
		\item Políticas de certificación.
		\item Certificado de TSA.
		\item Acceso S.O.
		\item Copia de seguridad de claves.
		\item Restauración.
	\end{itemize} 

	Estas operaciones serán detalladas a continuación.

	\subparagraph{Políticas de certificación}

	\input{politicas_variables_crl_01.tex}

	\subparagraph{Configuración de TSA}\label{config_tsa_stamp}

	En este apartado, el administrador de seguridad puede configurar los datos de la TSA para la firma de sellos de tiempo (Fig. \ref{tsa_2}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/tsa-configtsa-auth.png}
		\caption{Pantalla de configuración de TSA.}
		\label{tsa_2}
	\end{figure}

	Los parámetros que se pueden configurar son:
	\begin{itemize}
		\item \textbf{Nombre de TSA}: Se puede configurar que se use el atributo subject del certificado raíz en el sello de tiempo o bien se puede insertar un valor string en formato X500 (en caso de no cumplir este formato, se usará el valor del atributo subject del certificado). Si se configuran ambos valores, se dará preferencia al subject del certificado raíz.
		\item \textbf{OID de política}: Se refiere a los OID`s de política  admitidos en las peticiones de sellos de tiempo. En caso de no estar configurado este parámetro en la petición, el sello de tiempo en la respuesta será configurado con el primero de los OID`s configurados.
		\item \textbf{Algoritmo de firma}: Algoritmo con el que se firma el sello de tiempo.
		\item \textbf{Algoritmos aceptados}: Algoritmos de hash soportados en las peticiones.
		\item \textbf{Incluir hora de la firma}: Define si se quiere o no incluir la hora de la firma en el sello de tiempo.
		\item \textbf{Método autenticación}: Permite establecer el tipo de autenticación HTTP (Basic o Digest) del servicio Timestamp cuando la autenticación de usuarios está activada.
		\item \textbf{Cadena de certificación}: Si se quiere o no incluir toda la cadena de certificación en el sello de tiempo. En caso afirmativo, se deberá configurar la cadena de certificación de los certificados de CA de los que hereda el certificado de TSA raíz, siendo obligatorio al menos el certificado de CA subordinada, que en caso de ir solo se configura en el campo CA ROOT del formulario. Dicho de otro modo, solamente una de estas configuraciones es válida:
	\end{itemize}

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.6]{./img/tsa_3.png}
		\label{tsa_3}
	\end{figure}

	\subparagraph{Certificado TSA}\label{config_tsa_certs}

	Dentro de esta entrada del menú aparecerán las operaciones relativas a la configuración del certificado de TSA. Este es el certificado que firma los sellos de tiempo emitidos por el servicio TSP (sección \ref{servicio_tsp}).

	El proceso requiere la generación de una solicitud de certificado PKCS10 que se utilizará para generar el certificado en la CA. Una vez obtenido el certificado se deberá importar en la TSA en la opción correspondiente.

	\begin{itemize}
		\item \textbf{Generación PKCS10}
	\end{itemize}

	El administrador de seguridad, genera un PKCS10 mediante el cual, se emitirá en la CA, el certificado de TSA. Para ello, debe seleccionar la longitud de clave privada y se presiona el botón Generar (Fig. \ref{casub_3}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_3.png}
		\caption{Pantalla para generar PKCS10.}
		\label{casub_3}
	\end{figure}

	\begin{itemize}
		\item \textbf{Importar certificado}
	\end{itemize}

	En este apartado, debemos importar el certificado de TSA emitido a través de la CA Subordinada. (Fig. \ref{va_2}) mediante el pkcs10 generado en el punto anterior.

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/va_2.png}
		\caption{Pantalla de importación de certificado.}
		\label{va_2}
	\end{figure}

	\input{backup_certificados_operadores_01.tex}

	\input{admin_config_01.tex}

	\input{mantenimiento_bbdd_01.tex}

	\input{auditor_01.tex}

	\input{operador_sistemas_01.tex}
}

\newcommand{\tsaserviciotsp}[0]{
	\section{Servicio TSP}\label{servicio_tsp}

	El servicio TSP es el encargado de procesar las peticiones TSP enviadas sobre HTTP por las aplicaciones y servicios que solicitan sellos de tiempo a la TSA (por ejemplo para incorporarlos a firmas). Dicho servicio, envía las respuestas que contienen los sellos de tiempo emitidos  conforme al estándar [RFC3161] y a la configuración introducida por el administrador de seguridad (ver sección \ref{config_tsa_stamp}).

	La URL para acceder a dicho servicio es

	\url{http://IP_servidor/CryptosecOpenKey/tsa_service}

	Donde IP\_servidor es, como hemos indicado antes, la dirección ip por defecto del equipo indicada por el equipo de REALSEC.
}

\newcommand{\tsafaq}[0]{
	\input{preguntas_frecuentes_01.tex}
}

\input{pki.tex}