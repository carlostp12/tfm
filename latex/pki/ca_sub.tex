%document identification for conditional
\providecommand\jobname{ca_sub}

\newcommand{\casubadministracion}[0]{
	\section{Administración}
	Antes de poner en marcha el sistema es necesario inicializar el servicio, para ello habría que crear los certificados internos, también hay que editar las políticas ya que vienen configuradas unas políticas por defecto.
	Finalizada la instalación el sistema está preparado para dar el servicio de generación de certificados correspondiente, administrando los servicios de CA Subordinada a través de la interfaz de administración Web entre otras funcionalidades que se detallarán más adelante.

	\subsection{Asistente de instalación}

	\input{asistente_instalacion.tex}

	\subsection{Administración web}

	\input{administracion_web_01.tex}

	Así podremos acceder con diferentes permisos según los certificados que tengamos instalados. Los roles disponibles que encapsulan las operaciones habilitadas son:
	\begin{itemize}
		\item Auditor: Autorizado para ver los datos generados por la CA Subordinada (certificados emitidos, CRLs emitidos, operadores) y las trazas de las operaciones realizadas (logs).
		\item Operador de certificados: Responsable de emisión, revocación y suspensión de certificados de entidad final en la CA Subordinada.
		\item Administrador de Sistema: Están autorizados para instalar, mantener y configurar el Software de los equipos de la CA Subordinada siempre y cuando no afecte a la seguridad del mismo.
		\item Administrador de Seguridad: Tiene la responsabilidad general para la administración del Software de los equipos de la CA Subordinada siempre que afecten a la seguridad.
		\item Operador de sistema: Tiene la responsabilidad de monitorizar los equipos de la CA Subordinada y realizar operaciones de mantenimientos.
	\end{itemize}

	Entre las operaciones principales que podemos encontrar en la interfaz de administración se enumeran las siguientes, que se detallarán más adelante en el punto que corresponda:
	\begin{enumerate}
		\item Emisión de certificados de RA.
		\item Revocación, suspensión y rehabilitación de los certificados, se realiza mediante la operación correspondiente desde la RA.
		\item Emisión de CRL.
		\item Provisión de CRL a la RA.
		\item Provisión de políticas de certificación a la RA.
	\end{enumerate}

	Una vez seleccionado el rol con el que queremos acceder, el sistema nos muestra una ventana con la información referente a la última conexión, la integridad de la base de datos y la información de fecha y hora de actualización (Fig. \ref{caroot_fig17}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/caroot_fig17.png}
		\caption{Pantalla de información de la última conexión}
		\label{caroot_fig17}
	\end{figure}

	\subsubsection{Administración web para el rol Administrador de Seguridad}

	Mediante el rol administrador de seguridad, se pueden configurar los parámetros que condicionan el funcionamiento de los elementos software específicos de la CA Subordinada, generación e instalación de los certificados de miniCA, de servidor web, de operadores y de firma de certificados y CRL de la CA Subordinada, configuración de las políticas de certificación, de los atributos de políticas de certificación y de las autopolíticas de certificación. También se configura la RA, se generan peticiones para poder emitir certificados mediante la CA Raíz, y luego importar dicho certificado.

	La pantalla de administración web para el rol administrador de seguridad es (Fig. \ref{caroot_fig18}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/caroot_fig18.png}
		\caption{Pantalla de inicio de administración web para el rol administrador de seguridad.}
		\label{caroot_fig18}
	\end{figure}

	\paragraph{Administración}

	Este menú proporciona distintas opciones relacionadas con la configuración de seguridad del componente CA Root.  Las operaciones permitidas en el menú administración son:
	\begin{itemize}
		\item Políticas de certificación.
		\item Configuración de CRL.
		\item Configuración de RA.
		\item Certificado CA Subordinada.
		\item Acceso S.O.
		\item Copia de seguridad de claves.
		\item Restauración.
	\end{itemize}

	Estas operaciones serán detalladas a continuación.

	\subparagraph{Políticas de certificación}

	La opción \textit{Políticas de certificación} permite crear y editar las políticas y las autopolíticas correspondientes a la CA Subordinada, así como las variables necesarias para las mismas. Al seleccionar la opción se accederá a una pantalla que mostrará el listado de las políticas y políticas internas registradas en el sistema y un listado de las variables disponibles para utilizar en las políticas (Fig. \ref{caroot_fig19}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/caroot_fig19.png}
		\caption{Pantalla de políticas de certificación.}
		\label{caroot_fig19}
	\end{figure}

	\input{politicas_variables_crl_01.tex}

	\subparagraph{Configuración de RA}

	En esta sección, importamos el certificado de RA emitido por la CA Subordinada mediante la petición generada por la RA, para poder conectar la CA Subordinada con la RA(Fig. \ref{casub_1}).

	Una vez importado, dicho certificado, aparece en la interfaz un listado con las RA`s que tenemos configuradas en nuestra CA Subordinada (Fig. \ref{casub_2}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_1.png}
		\caption{Pantalla para importar certificado RA.}
		\label{casub_1}
	\end{figure}

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_2.png}
		\caption{Pantalla con las RA`s disponibles.}
		\label{casub_2}
	\end{figure}
	
	Haciendo click en el id de la RA se pueden añadir las políticas de Certificación y las autoridades de las que permitiremos que la RA emita certificados.

	\subparagraph{Certificado CA Subordinada}

	\begin{itemize}
		\item \textbf{Generación PKCS10}
	\end{itemize}

	El administrador de seguridad, generará PKCS10 para poder emitir en la CA ROOT un certificado de CA Subordinada inicial, para ello debe seleccionar la autoridad si hay más de una y pulsar en el botón etiquetado como 'generar', que nos crearia una request con el tamaño de clave que esté configurado en la política de certificación correspondiente o bien 'Configurar', lo que nos permitirá configurar la autopolítica correspondiente (Fig. \ref{casub_3}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_3.png}
		\caption{Pantalla para generar PKCS10.}
		\label{casub_3}
	\end{figure}

	\begin{itemize}
		\item \textbf{Importar certificado}
	\end{itemize}

	En esta sección, el Administrador de Seguridad, importa el certificado emitido por la CA Raíz, el cual, ha sido generado mediante la petición anterior. Se ha de seleccionar la autoridad correspondiente al certificado a importar (Fig. \ref{casub_4}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_4.png}
		\caption{Pantalla para importar certificado CA Subordinada.}
		\label{casub_4}
	\end{figure}

	\input{backup_certificados_operadores_01.tex}

	\input{admin_config_01.tex}

	\subparagraph{Mantenimiento base de datos}\label{mantenimiento_bbdd}

	En esta sección, podemos consultar el nivel de fragmentación de la base de datos, así como realizar una compactación ligera (la cual no bloquea la base de datos) y una compactación completa (la cual bloquea la base de datos). También podemos configurar un backup periódico, para ello debemos introducir cada cuanto tiempo queremos que se genere dicho backup o poner a qué hora del día queremos que se lleve a cabo dicha acción. Además, podemos recuperar las credenciales de acceso para la consulta de la VA, para ello, debemos presionar \includegraphics[scale=1]{./img/icono_refresh_backup.png} y nos aparece la información. (Fig. \ref{casub_7}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/casub_7.png}
		\caption{Pantalla para fragmentar la base de datos.}
		\label{casub_7}
	\end{figure}

	\subsubsection{Administración web para el rol Operador de Certificado}

	Mediante el rol operador de certificado, se pueden emitir certificados de RA, incluyendo su descarga en un fichero en formato PEM; revocación, suspensión y rehabilitación de los certificados de CA Subordinada y consulta de los certificados emitidos, incluyendo su descarga en un fichero en formato PEM.

	La pantalla de administración web para el rol operador de certificado es (Fig. \ref{caroot_fig80}).

	\begin{figure}[H]
		\centering
		\includegraphics[scale=.5]{./img/caroot_fig80.png}
		\caption{Pantalla de inicio de administración web para el rol operador.}
		\label{caroot_fig80}
	\end{figure}

	\paragraph{Operaciones}

	\input{emision_certificados_01.tex}

	\input{consultaCert_01.tex}

	\input{auditor_01.tex}

	\input{operador_sistemas_01.tex}
}

\newcommand{\casubfaq}[0]{
	\input{preguntas_frecuentes_01.tex}
}

\input{pki.tex}