\documentclass[a4paper,12pt,titlepage]{article}
% Con este package usa las fuentes Latin Modern Roman (http://www.tug.dk/FontCatalogue/latinmodernroman/)
% En pantalla en el pdf se ven las fuentes mas oscuras (hacer mini-prueba de impresión)
% \usepackage {lmodern}
\usepackage[scaled=1]{couriers}
\usepackage [spanish] {babel} 
\usepackage [T1]{fontenc}
\usepackage [utf8]{inputenc}
\usepackage {lipsum}
\usepackage [vmargin=1cm,hmargin=2cm,head=26pt,includeheadfoot]{geometry}
\usepackage {fancyhdr}
\usepackage {graphicx}
\usepackage {marginnote}
\usepackage {eso-pic}
\usepackage {booktabs}
\usepackage {float}
\usepackage {tikz}
\usepackage [breaklinks=true,hidelinks]{hyperref}
\usepackage {color}
\usepackage {ifthen}
\usepackage {caption}
\usepackage {parskip}
\usepackage {svn-multi}
\usepackage {verbatim}
\usepackage {soul}
\svnid{$Id: integracionRA-CA.tex 2355 2019-03-13 08:55:09Z antonio.ocana $}

\makeatletter

\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
            {-2.5ex\@plus -1ex \@minus -.25ex}%
            {1.25ex \@plus .25ex}%
            {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{5}{\z@}%
            {-2.5ex\@plus -1ex \@minus -.25ex}%
            {1.25ex \@plus .25ex}%
            {\normalfont\normalsize\bfseries}}
\makeatother

\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

%defino color azul para los enlaces
\definecolor{ColorEnlaces}{rgb}{0,0,1}
\definecolor{verde}{RGB}{155,187,89}
\definecolor{gris}{RGB}{220,220,220}

\hypersetup{
    colorlinks=true,%para colorear los enlaces
    urlcolor=blue,
    linkcolor=blue
}

\fancyhead{}
\fancyfoot{}
\fancyhead[L]{\begin{picture}(0,0) \put(0,0){\includegraphics[scale=.4]{./img/logorealsec.eps}} \end{picture}}
\fancyhead[R]{\begin{picture}(0,0) \put(-90,0){\includegraphics[scale=.4]{./img/encabezado_dcho.eps}} \end{picture}}
\fancyfoot[L]{\marginnote{\begin{picture}(0,0) \put(-525,400){\rotatebox[origin=c]{90}{\begin{tikzpicture}\node [opacity=0.5] (0,0){\tiny La propiedad intelectual de este documento pertenece a \textbf{REALSEC}. Queda prohibida su reproducción, venta, o cesión a terceros.};\end{tikzpicture}}} \end{picture}}[0cm]}
\fancyfoot[C]{Realia Technologies, S.L. \hfill Page \small \thepage \hfill \small \today}
\fancyfoot[R]{\small \today}

\pagestyle{fancy}


\begin{document}
%pagina 1: PORTADA
\thispagestyle{empty}
{
	\null\vfill
	\centering\begin{picture}(0,0) \put(-70,170){\includegraphics[scale=.4]{./img/logo_portada.png}} \end{picture}
	\AddToShipoutPicture{\put(90,190){\includegraphics[scale=1]{./img/cover_background.png}}}
	{\Huge \textbf{CryptosecOpenKey}}\\
	\textcolor{verde}{\\\rule{150mm}{0.3mm}\\}
	\Large\textbf{\\Manual de integración de la RA con la CA (Subordinada o Root online)\\}
	{Rev. 1.0.\svnrev\\}
	\vfill
	{\normalsize \textbf{REALIA TECHNOLOGIES, SL} \hfill \small \today }
}

\newpage
%pagina 2: CONTROL DE VERSIONES
%esto introduce una marca de agua
\AddToShipoutPicture{\put(0,0){\includegraphics[width=\paperwidth,height=\paperheight]{./img/fondo.eps}}}
\thispagestyle{empty}

\begin{table}[H]
	\centering
	\renewcommand{\arraystretch}{1.5}
	\begin{tabular}{cccc}
		\toprule
		Version & Fecha & Componentes & Breve descripcion del cambio \\
		\cmidrule[1pt](r){1-1}\cmidrule[1pt](lr){2-2}\cmidrule[1pt](lr){3-3}\cmidrule[1pt](lr){4-4}
		1.0.0 & 04/07/2014 & Todo & Versión inicial \\
		\midrule
		1.0.1 & 12/12/2018 & Documentación & Cambio a formato LaTeX \\
		\bottomrule
	\end{tabular}
	\caption{Control de versiones}
\end{table}

\newpage
%paginas siguientes : PAGINAS CON CONTENIDO

\begin{figure}[H]
	\centering
	\includegraphics[scale=.7]{./img/CA-02-portada.jpg}
	\label{servidor}
\end{figure}

{\Large\textbf{\ul{Pasos para integrar la RA con la CA (Subordinada o Root online)}}}

\begin{enumerate}
	\item El operador con el rol Administrador de Seguridad en la RA genera un PKCS10 mediante la opción: \textit{Administración} ->\ \textit{Certificado RA} ->\ \textit{Generación PKCS10}, aquí el operador debe seleccionar la longitud de clave privada RSA, dicho tamaño debe ser igual al configurado en la política de RA inicial.
	\item En la CA (Subordinada o root online), el Operador de Certificados a través de la opción: \textit{Operaciones} ->\ \textit{Certificados} ->\ \textit{Emisión}, debe importar el PKCS10 generado a través de la RA, una vez generado el mismo, debe ser descargado.
	\item En la CA (Subordinada o Root online), el Administrador de Seguridad, mediante la opción: \textit{Administración} ->\ \textit{Configuración de RA}, debe importar el certificado de RA emitido previamente, para ello debe presionar Examinar, buscar el certificado y presionar Importar. Una vez importado, arriba del cuadro para importar, aparece un listado con las RA que tenemos configuradas en nuestra CA (Subordinada o Root online), debemos presionar sobre el ID para añadirle a dicho certificado de RA las políticas a las cuales queremos que tenga acceso.
	\item En la RA, el operador con el rol Administrador de Seguridad importa el certificado raíz de RA emitido por la CA (Subordinada o Root online) mediante la opción: \textit{Administración} ->\ \textit{Certificado RA} ->\ \textit{Importar certificado}. Para ello, presiona Examinar, busca el certificado y presiona Importar.
	\item El Administrador de Sistemas en la RA, debe configurar la CA, para ello mediante la opción \textit{Configuración} ->\ \textit{Configuración de CA} ->\ \textit{IP/Host de CA} debe añadir la IP/Host correspondiente a la CA, así como también debe importar los certificados de servidor web y miniCA en los lugares destinados para ello.
	\item El Administrador de Sistemas en la RA, debe configurar la CA, para ello mediante la opción \textit{Configuración} ->\ \textit{Configuración de CA} ->\ \textit{Publicadores de CRL}, puede añadir publicadores de CRL, para ello debe presionar `Crear nueva' e indicar el Host, Path, Usuario y Password, en dicho destino serán publicadas las CRL. Debe seleccionar el publicador en el cual quiere que se almacenen.
	\item El Administrador de Sistemas en la RA, debe configurar la conexión a LDAP, para ello mediante la opción \textit{Configuración} ->\ \textit{Configuración acceso LDAP}, donde debe indicar el protocolo de seguridad utilizado, el host, el puerto, URL DNS, el usuario, la contraseña, el dominio raíz, el DN de la CA (Subordinada o Root online), así como importar el certificado emisor de AD.
	\item El Administrador de Seguridad de la RA, debe sincronizar las políticas; esto puede realizarlo mediante dos opciones: \textit{Administración} ->\ \textit{Sincronizar Políticas o Administración} ->\ \textit{Políticas de Certificación} ->\ \textit{Sincronizar Políticas} y presionar Sincronizar. De éste modo, se sincronizan las políticas configuradas en la CA (Subordinada o root online) para la RA.
	\item El Administrador de Seguridad de la RA, debe configurar los tipos de usuarios; esta acción se lleva a cabo mediante \textit{Gestión de Acceso} ->\ \textit{Roles dinámicos} ->\ \textit{Configurar tipos de usuarios}. Para crear uno nuevo, debemos escribir un nombre y una descripción y presionar Crear nuevo, dicho usuario aparecerá en un listado en la parte inferior. Para modificar dichos tipos de usuario, debemos presionar Añadir/Borrar Políticas, donde debemos asignar a cada usuario las políticas a las que queremos darle acceso.
	\item El Administrador de Seguridad de la RA, debe sincronizar las políticas; esto puede realizarlo mediante \textit{Gestión de Acceso} ->\ \textit{Roles dinámicos} ->\ \textit{Roles dinámicos}, se configuran los roles dinámicos, así como podemos añadir un rol dinámico nuevo. Para añadir uno nuevo, se escribe el nombre y se presiona `Crear Nuevo' y aparece en el listado inferior de Roles dinámicos., para modificar éstos, debemos presionar Añadir/Borrar Tipos de usuario, en el que aparece un listado con los tipos de usuarios y otro con los tipos de usuarios ya existentes en el rol, para ello hay que incluir en los ya existentes en el rol los tipos de usuarios que queramos que tengan acceso con dicho rol. Lo mismo hay que hacer en Añadir/Borrar Políticas, para asignarle al rol las políticas a las que queremos que tenga acceso dicho rol.
	\item El Administrador de Seguridad de la RA, debe configurar los operadores; esto puede realizarlo mediante \textit{Gestión de Acceso} ->\ \textit{Roles dinámicos} ->\ \textit{Configurar operadores}, se presiona Buscar y aparece el listado con los operadores disponibles. Seleccionamos el operador que queramos configurar y presionamos Seleccionar Usuario, en la nueva ventana, nos aparecen dos listados, uno con los roles disponibles y otro con los roles de operador, debiendo incluir en el listado de los roles de operador los roles dinámicos a los cuales se le quiere dar acceso.
	\item En el Active Directory, cada usuario debe tener configurado en Cert Policies el nombre de las políticas con las que puede emitir certificados, éstas tienen que tener el mismo nombre que las configuradas en la CA (Subordinada o Root online), en caso de no tener políticas configuradas, el usuario no podrá emitir certificados.
\end{enumerate}

\end{document}