sprintf('Number of galaxies in groups with more than %s elements %s out of %s, aprox %s percent',
min_members,
number_non_isolated_galaxies,
dim(mm)[1], format(number_non_isolated_galaxies * 100
/dim(mm)[1], digits=4)))
print(sprintf("Number of groups with more than %s members: %s",
min_members,
true_groups))
hhh<- h[h$members>=min_members, ]
ttable <- table(hhh$GROUP_ID, hhh$members)
barplot(ttable, col=('red'),
main=sprintf("Group distribution (%s) with at least %s members ",
true_groups,
min_members))
boxplot(hhh$members, main="Boxplot of wt")
plot3d(mm$x, mm$y, mm$z, col = 'black',
size = 1, xlab = "X", ylab = "Y", zlab = "Z")
aa <- sqldf("select
GAL_ID,
x,
y,
z,
case
when group_id IN (Select GROUP_ID from mm5) then group_id
else 0
end as group_id,
redshift,
dist
from
mm")
plot3d(aa$x, aa$y, aa$z, col = aa$group_id+1,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
plot3d(mm5$x, mm5$y, mm5$z, col = mm5$GROUP_ID,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
sys.source(sprintf("%s\\assess.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\calculate_stats.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\plotting_functions.r", includes_folder),  envir = knitr::knit_global())
points<- mm[,c('x', 'y', 'z')]
#clustering
res <- optics(points, minPts = min_members)
plot(res)
optics <- extractXi(res, xi=0.15)
plot(optics)
plot3D_cluster(optics, mm)
blo_scan <- extractDBSCAN(res, eps_cl = 0.00075)
mm$cluster_id <- blo_scan$cluster
mm5 <- get_elements_in_m5_groups(mm)
plot(blo_scan)
plot3D_cluster(blo_scan, points)
print_global_stats(x_stats, eps_sequence_test)
knitr::opts_chunk$set(echo = TRUE)
if (!require('jsonlite')) install.packages('jsonlite')
library(jsonlite)
if (!require('dbscan')) install.packages('dbscan')
library(dbscan)
if (!require('readr')) install.packages('readr')
library(readr)
if (!require('rjson')) install.packages('rjson')
library(rjson)
if (!require('dplyr')) install.packages('dplyr')
library(dplyr)
if (!require('akima')) install.packages('akima')
library(akima)
if (!require('astrolibR')) install.packages("astrolibR")
library(astrolibR)
if (!require('scatterplot3d')) install.packages("scatterplot3d")
library(scatterplot3d)
if (!require('gMOIP')) install.packages("gMOIP")
library(gMOIP)
if (!require('ggplot2')) install.packages("ggplot2")
library(ggplot2)
if (!require('rgl')) install.packages("rgl")
library(rgl)
if (!require('pracma')) install.packages("pracma")
library(pracma)
if (!require('plotly')) install.packages("plotly")
library(plotly)
if (!require('sqldf')) install.packages("sqldf")
library(sqldf)
if (!require('tidyr')) install.packages("tidyr")
library(tidyr)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
######################
#     Galaxy SDSS loading #
######################
folder <- Sys.getenv('PROJECT_TFM')
includes_folder  <- sprintf('%s\\R\\includes\\', folder)
folder <- sprintf('%s\\data\\groups\\sdss_real\\', folder)
print(folder)
file <- sprintf('%sSDSS7-valid.csv', folder)
setwd(folder)
dt <- read.csv(file)
str(dt)
sLos <- 0.4 #Here the slos is fixed beforehand
min_members <- 5
ra_lim_inf <- 90
ra_lim_sup <- 150
dec_lim_inf <- 15
dec_lim_sup <-  25
max_redshift <- 0.08
min_redshift <- 0.025
# Take a sample using boundaries
mm <- dt[ dt$ra<= ra_lim_sup & dt$ra>=ra_lim_inf &
dt$dec>= dec_lim_inf & dt$dec<=dec_lim_sup &
dt$redshift< max_redshift & dt$redshift> min_redshift,]
# mm is an object containing both groups and galaxy identification
ggplot(mm, aes(x=redshift, y=redshift))+geom_violin()
dim(mm)
h<-sqldf("select
count(GAL_ID) as members,
GROUP_ID
from mm
group by GROUP_ID
order by  members desc")
mm5<-sqldf(sprintf("
SELECT
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist
FROM
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s"
, min_members))
get_elements_in_m5_groups <- function(mm){
groups_in_mm5<-sqldf(sprintf("
select
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist,
mm.cluster_id
from
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s", min_members))
groups_in_mm5
}
true_groups <- length(unique(mm5$GROUP_ID))
number_non_isolated_galaxies <- dim(mm5)[1]
number_isolated_galaxies <- dim(mm)[1] - dim(mm5)[1]
print(
sprintf('Number of galaxies in groups with more than %s elements %s out of %s, aprox %s percent',
min_members,
number_non_isolated_galaxies,
dim(mm)[1], format(number_non_isolated_galaxies * 100
/dim(mm)[1], digits=4)))
print(sprintf("Number of groups with more than %s members: %s",
min_members,
true_groups))
hhh<- h[h$members>=min_members, ]
ttable <- table(hhh$GROUP_ID, hhh$members)
barplot(ttable, col=('red'),
main=sprintf("Group distribution (%s) with at least %s members ",
true_groups,
min_members))
boxplot(hhh$members, main="Boxplot of wt")
plot3d(mm$x, mm$y, mm$z, col = 'black',
size = 1, xlab = "X", ylab = "Y", zlab = "Z")
aa <- sqldf("select
GAL_ID,
x,
y,
z,
case
when group_id IN (Select GROUP_ID from mm5) then group_id
else 0
end as group_id,
redshift,
dist
from
mm")
plot3d(aa$x, aa$y, aa$z, col = aa$group_id+1,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
plot3d(mm5$x, mm5$y, mm5$z, col = mm5$GROUP_ID,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
sys.source(sprintf("%s\\assess.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\calculate_stats.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\plotting_functions.r", includes_folder),  envir = knitr::knit_global())
points<- mm[,c('x', 'y', 'z')]
#clustering
res <- optics(points, minPts = min_members)
plot(res)
optics <- extractXi(res, xi=0.15)
plot(optics)
plot3D_cluster(optics, mm)
blo_scan <- extractDBSCAN(res, eps_cl = 0.00075)
mm$cluster_id <- blo_scan$cluster
mm5 <- get_elements_in_m5_groups(mm)
plot(blo_scan)
plot3D_cluster(blo_scan, points)
print_stats(all)
knitr::opts_chunk$set(echo = TRUE)
if (!require('jsonlite')) install.packages('jsonlite')
library(jsonlite)
if (!require('dbscan')) install.packages('dbscan')
library(dbscan)
if (!require('readr')) install.packages('readr')
library(readr)
if (!require('rjson')) install.packages('rjson')
library(rjson)
if (!require('dplyr')) install.packages('dplyr')
library(dplyr)
if (!require('akima')) install.packages('akima')
library(akima)
if (!require('astrolibR')) install.packages("astrolibR")
library(astrolibR)
if (!require('scatterplot3d')) install.packages("scatterplot3d")
library(scatterplot3d)
if (!require('gMOIP')) install.packages("gMOIP")
library(gMOIP)
if (!require('ggplot2')) install.packages("ggplot2")
library(ggplot2)
if (!require('rgl')) install.packages("rgl")
library(rgl)
if (!require('pracma')) install.packages("pracma")
library(pracma)
if (!require('plotly')) install.packages("plotly")
library(plotly)
if (!require('sqldf')) install.packages("sqldf")
library(sqldf)
if (!require('tidyr')) install.packages("tidyr")
library(tidyr)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
######################
#     Galaxy SDSS loading #
######################
folder <- Sys.getenv('PROJECT_TFM')
includes_folder  <- sprintf('%s\\R\\includes\\', folder)
folder <- sprintf('%s\\data\\groups\\sdss_real\\', folder)
print(folder)
file <- sprintf('%sSDSS7-valid.csv', folder)
setwd(folder)
dt <- read.csv(file)
str(dt)
sLos <- 0.4 #Here the slos is fixed beforehand
min_members <- 5
ra_lim_inf <- 90
ra_lim_sup <- 150
dec_lim_inf <- 15
dec_lim_sup <-  25
max_redshift <- 0.08
min_redshift <- 0.025
# Take a sample using boundaries
mm <- dt[ dt$ra<= ra_lim_sup & dt$ra>=ra_lim_inf &
dt$dec>= dec_lim_inf & dt$dec<=dec_lim_sup &
dt$redshift< max_redshift & dt$redshift> min_redshift,]
# mm is an object containing both groups and galaxy identification
ggplot(mm, aes(x=redshift, y=redshift))+geom_violin()
dim(mm)
h<-sqldf("select
count(GAL_ID) as members,
GROUP_ID
from mm
group by GROUP_ID
order by  members desc")
mm5<-sqldf(sprintf("
SELECT
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist
FROM
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s"
, min_members))
get_elements_in_m5_groups <- function(mm){
groups_in_mm5<-sqldf(sprintf("
select
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist,
mm.cluster_id
from
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s", min_members))
groups_in_mm5
}
true_groups <- length(unique(mm5$GROUP_ID))
number_non_isolated_galaxies <- dim(mm5)[1]
number_isolated_galaxies <- dim(mm)[1] - dim(mm5)[1]
print(
sprintf('Number of galaxies in groups with more than %s elements %s out of %s, aprox %s percent',
min_members,
number_non_isolated_galaxies,
dim(mm)[1], format(number_non_isolated_galaxies * 100
/dim(mm)[1], digits=4)))
print(sprintf("Number of groups with more than %s members: %s",
min_members,
true_groups))
hhh<- h[h$members>=min_members, ]
ttable <- table(hhh$GROUP_ID, hhh$members)
barplot(ttable, col=('red'),
main=sprintf("Group distribution (%s) with at least %s members ",
true_groups,
min_members))
boxplot(hhh$members, main="Boxplot of wt")
plot3d(mm$x, mm$y, mm$z, col = 'black',
size = 1, xlab = "X", ylab = "Y", zlab = "Z")
aa <- sqldf("select
GAL_ID,
x,
y,
z,
case
when group_id IN (Select GROUP_ID from mm5) then group_id
else 0
end as group_id,
redshift,
dist
from
mm")
plot3d(aa$x, aa$y, aa$z, col = aa$group_id+1,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
plot3d(mm5$x, mm5$y, mm5$z, col = mm5$GROUP_ID,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
sys.source(sprintf("%s\\assess.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\calculate_stats.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\plotting_functions.r", includes_folder),  envir = knitr::knit_global())
points<- mm[,c('x', 'y', 'z')]
#clustering
res <- optics(points, minPts = min_members)
plot(res)
optics <- extractXi(res, xi=0.15)
plot(optics)
plot3D_cluster(optics, mm)
blo_scan <- extractDBSCAN(res, eps_cl = 0.00075)
mm$cluster_id <- blo_scan$cluster
mm5 <- get_elements_in_m5_groups(mm)
plot(blo_scan)
plot3D_cluster(blo_scan, points)
knitr::opts_chunk$set(echo = TRUE)
if (!require('jsonlite')) install.packages('jsonlite')
library(jsonlite)
if (!require('dbscan')) install.packages('dbscan')
library(dbscan)
if (!require('readr')) install.packages('readr')
library(readr)
if (!require('rjson')) install.packages('rjson')
library(rjson)
if (!require('dplyr')) install.packages('dplyr')
library(dplyr)
if (!require('akima')) install.packages('akima')
library(akima)
if (!require('astrolibR')) install.packages("astrolibR")
library(astrolibR)
if (!require('scatterplot3d')) install.packages("scatterplot3d")
library(scatterplot3d)
if (!require('gMOIP')) install.packages("gMOIP")
library(gMOIP)
if (!require('ggplot2')) install.packages("ggplot2")
library(ggplot2)
if (!require('rgl')) install.packages("rgl")
library(rgl)
if (!require('pracma')) install.packages("pracma")
library(pracma)
if (!require('plotly')) install.packages("plotly")
library(plotly)
if (!require('sqldf')) install.packages("sqldf")
library(sqldf)
if (!require('tidyr')) install.packages("tidyr")
library(tidyr)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
if (!require('densityClust')) install.packages('densityClust')
library(densityClust)
######################
#     Galaxy SDSS loading #
######################
folder <- Sys.getenv('PROJECT_TFM')
includes_folder  <- sprintf('%s\\R\\includes\\', folder)
folder <- sprintf('%s\\data\\groups\\sdss_real\\', folder)
print(folder)
file <- sprintf('%sSDSS7-valid.csv', folder)
setwd(folder)
dt <- read.csv(file)
str(dt)
sLos <- 0.4 #Here the slos is fixed beforehand
min_members <- 5
ra_lim_inf <- 90
ra_lim_sup <- 150
dec_lim_inf <- 15
dec_lim_sup <-  25
max_redshift <- 0.08
min_redshift <- 0.025
# Take a sample using boundaries
mm <- dt[ dt$ra<= ra_lim_sup & dt$ra>=ra_lim_inf &
dt$dec>= dec_lim_inf & dt$dec<=dec_lim_sup &
dt$redshift< max_redshift & dt$redshift> min_redshift,]
# mm is an object containing both groups and galaxy identification
ggplot(mm, aes(x=redshift, y=redshift))+geom_violin()
dim(mm)
h<-sqldf("select
count(GAL_ID) as members,
GROUP_ID
from mm
group by GROUP_ID
order by  members desc")
mm5<-sqldf(sprintf("
SELECT
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist
FROM
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s"
, min_members))
get_elements_in_m5_groups <- function(mm){
groups_in_mm5<-sqldf(sprintf("
select
mm.GAL_ID,
mm.x,
mm.y,
mm.z,
mm.GROUP_ID,
mm.redshift,
mm.dist,
mm.cluster_id
from
mm as mm, h
where
mm.GROUP_ID=h.GROUP_ID and
h.members >= %s", min_members))
groups_in_mm5
}
true_groups <- length(unique(mm5$GROUP_ID))
number_non_isolated_galaxies <- dim(mm5)[1]
number_isolated_galaxies <- dim(mm)[1] - dim(mm5)[1]
print(
sprintf('Number of galaxies in groups with more than %s elements %s out of %s, aprox %s percent',
min_members,
number_non_isolated_galaxies,
dim(mm)[1], format(number_non_isolated_galaxies * 100
/dim(mm)[1], digits=4)))
print(sprintf("Number of groups with more than %s members: %s",
min_members,
true_groups))
hhh<- h[h$members>=min_members, ]
ttable <- table(hhh$GROUP_ID, hhh$members)
barplot(ttable, col=('red'),
main=sprintf("Group distribution (%s) with at least %s members ",
true_groups,
min_members))
boxplot(hhh$members, main="Boxplot of wt")
plot3d(mm$x, mm$y, mm$z, col = 'black',
size = 1, xlab = "X", ylab = "Y", zlab = "Z")
aa <- sqldf("select
GAL_ID,
x,
y,
z,
case
when group_id IN (Select GROUP_ID from mm5) then group_id
else 0
end as group_id,
redshift,
dist
from
mm")
plot3d(aa$x, aa$y, aa$z, col = aa$group_id+1,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
plot3d(mm5$x, mm5$y, mm5$z, col = mm5$GROUP_ID,
size = 2, xlab = "X", ylab = "Y", zlab = "Z")
sys.source(sprintf("%s\\assess.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\calculate_stats.r", includes_folder), envir = knitr::knit_global())
sys.source(sprintf("%s\\plotting_functions.r", includes_folder),  envir = knitr::knit_global())
points<- mm[,c('x', 'y', 'z')]
#clustering
res <- optics(points, minPts = min_members)
plot(res)
optics <- extractXi(res, xi=0.15)
plot(optics)
plot3D_cluster(optics, mm)
blo_scan <- extractDBSCAN(res, eps_cl = 0.00075)
mm$cluster_id <- blo_scan$cluster
mm5 <- get_elements_in_m5_groups(mm)
plot(blo_scan)
plot3D_cluster(blo_scan, points)
all <- execute_stats(mm, blo_scan)
head(all, 5)
